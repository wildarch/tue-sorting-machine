<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>// Mode (0 = fast, 1 = safe, 2 = incremental)
const int mode = 1;
int machinePaused = 0;

// Buttons
chan button_startpause, button_reset, button_abort;

// Timer
chan timer_start, timer_dfa, timer_toolate;

// Pressure sensor
chan gyro_test, gyro_left, gyro_right, gyro_stable;

// Color sensor
chan color_test, color_black, color_white, color_unknown, color_nothing;

// Motor
chan motor_left, motor_right, motor_stopped, motor_jammed;

broadcast chan reset_per;
</declaration><template><name x="8" y="8">GyroSensor</name><declaration>clock t;</declaration><location id="id0" x="-1168" y="-424"></location><location id="id1" x="-848" y="-424"></location><location id="id2" x="-1000" y="-424"></location><init ref="id2"/><transition><source ref="id1"/><target ref="id2"/><label kind="synchronisation" x="-920" y="-720">reset_per?</label><nail x="-888" y="-704"/></transition><transition><source ref="id0"/><target ref="id2"/><label kind="synchronisation" x="-1136" y="-608">reset_per?</label><nail x="-1096" y="-592"/></transition><transition><source ref="id1"/><target ref="id2"/><label kind="synchronisation" x="-976" y="-536">gyro_stable!</label><nail x="-936" y="-512"/></transition><transition><source ref="id0"/><target ref="id2"/><label kind="synchronisation" x="-1120" y="-448">gyro_stable!</label></transition><transition><source ref="id1"/><target ref="id0"/><label kind="synchronisation" x="-1016" y="-312">gyro_right!</label><nail x="-976" y="-312"/></transition><transition><source ref="id1"/><target ref="id0"/><label kind="synchronisation" x="-944" y="-624">gyro_left!</label><nail x="-920" y="-592"/></transition><transition><source ref="id2"/><target ref="id1"/><label kind="synchronisation" x="-968" y="-448">gyro_test?</label></transition></template><template><name>ReinhardHeinrichBertramVinzenzFreiherrvonPeldengenanntCloudtzuLauersfortundImpel</name><declaration>clock t;</declaration><location id="id3" x="-1792" y="-400"></location><location id="id4" x="-1464" y="224" color="#ffa500"><name x="-1474" y="194">WARNING2</name></location><location id="id5" x="-1192" y="-16"></location><location id="id6" x="-1256" y="80"></location><location id="id7" x="-1480" y="-616" color="#ffa500"><name x="-1490" y="-646">WARNING</name></location><location id="id8" x="-1192" y="-192"><name x="-1168" y="-224">STABLE</name></location><location id="id9" x="-1192" y="-344"></location><location id="id10" x="-1264" y="-456"></location><location id="id11" x="-1816" y="-592" color="#ff0000"><name x="-1840" y="-624">ABORT</name></location><location id="id12" x="-1512" y="0"><name x="-1576" y="-8">paused</name></location><location id="id13" x="-440" y="48" color="#00ff00"><name x="-464" y="72">DONE</name></location><location id="id14" x="-1088" y="168" color="#ffffff"><name x="-1072" y="160">white_detected</name></location><location id="id15" x="-1088" y="-560" color="#000000"><name x="-1072" y="-568">black_detected</name></location><location id="id16" x="-1512" y="-192"><name x="-1552" y="-224">read_color</name></location><location id="id17" x="-1712" y="-192"><name x="-1728" y="-224">INIT</name></location><location id="id18" x="-1328" y="168" color="#ffffff"><name x="-1416" y="152">move_right</name></location><location id="id19" x="-1328" y="-560" color="#000000"><name x="-1408" y="-576">move_left</name></location><location id="id20" x="-1088" y="-192"><name x="-1128" y="-176">check_color</name><label kind="invariant" x="-1056" y="-200">machinePaused == 0</label></location><init ref="id17"/><transition><source ref="id3"/><target ref="id17"/><label kind="synchronisation" x="-1812" y="-311">reset_per!</label></transition><transition><source ref="id11"/><target ref="id3"/><label kind="synchronisation" x="-1864" y="-511">button_reset?</label></transition><transition><source ref="id4"/><target ref="id18"/></transition><transition><source ref="id18"/><target ref="id4"/><label kind="synchronisation" x="-1456" y="181">timer_dfa?</label><nail x="-1416" y="192"/></transition><transition><source ref="id18"/><target ref="id11"/><label kind="synchronisation" x="-1840" y="168">motor_jammed?</label><nail x="-2016" y="168"/><nail x="-2008" y="-648"/></transition><transition><source ref="id19"/><target ref="id11"/><label kind="synchronisation" x="-1488" y="-512">motor_jammed?</label><nail x="-1512" y="-512"/></transition><transition><source ref="id18"/><target ref="id11"/><label kind="synchronisation" x="-1768" y="136">timer_toolate?</label><nail x="-1424" y="128"/><nail x="-1992" y="128"/><nail x="-1992" y="-632"/></transition><transition><source ref="id19"/><target ref="id11"/><nail x="-1520" y="-536"/></transition><transition><source ref="id8"/><target ref="id12"/><label kind="guard" x="-1312" y="-128">mode == 2</label><label kind="synchronisation" x="-1320" y="-112">gyro_stable?</label><nail x="-1264" y="-64"/></transition><transition><source ref="id12"/><target ref="id17"/><label kind="synchronisation" x="-1688" y="-24">button_reset?</label><nail x="-1712" y="0"/></transition><transition><source ref="id20"/><target ref="id14"/><label kind="synchronisation" x="-960" y="-64">color_unknown?</label><nail x="-976" y="-96"/><nail x="-968" y="112"/></transition><transition><source ref="id5"/><target ref="id11"/><label kind="synchronisation" x="-1744" y="104">gyro_left?</label><nail x="-1384" y="-8"/><nail x="-1456" y="104"/><nail x="-1904" y="104"/><nail x="-1920" y="-568"/></transition><transition><source ref="id5"/><target ref="id11"/><label kind="synchronisation" x="-1752" y="64">timer_toolate?</label><nail x="-1392" y="-16"/><nail x="-1464" y="88"/><nail x="-1888" y="80"/><nail x="-1896" y="-560"/></transition><transition><source ref="id5"/><target ref="id8"/><label kind="synchronisation" x="-1184" y="-104">gyro_right?</label></transition><transition><source ref="id6"/><target ref="id5"/><label kind="synchronisation" x="-1284" y="17">gyro_test!</label></transition><transition><source ref="id18"/><target ref="id6"/><label kind="guard" x="-1288" y="112">mode &gt; 0</label><label kind="synchronisation" x="-1288" y="128">motor_stopped?</label></transition><transition><source ref="id7"/><target ref="id19"/><nail x="-1424" y="-568"/></transition><transition><source ref="id19"/><target ref="id7"/><label kind="synchronisation" x="-1440" y="-632">timer_dfa?</label><nail x="-1400" y="-608"/></transition><transition><source ref="id8"/><target ref="id11"/><label kind="synchronisation" x="-1544" y="-400">timer_toolate?</label><nail x="-1600" y="-400"/></transition><transition><source ref="id8"/><target ref="id16"/><label kind="guard" x="-1424" y="-304">mode == 1</label><label kind="synchronisation" x="-1424" y="-288">gyro_stable?</label><nail x="-1240" y="-264"/><nail x="-1456" y="-264"/></transition><transition><source ref="id9"/><target ref="id11"/><label kind="synchronisation" x="-1560" y="-472">gyro_right?</label><nail x="-1560" y="-448"/></transition><transition><source ref="id9"/><target ref="id11"/><label kind="synchronisation" x="-1568" y="-568">timer_toolate?</label></transition><transition><source ref="id9"/><target ref="id8"/><label kind="synchronisation" x="-1176" y="-280">gyro_left?</label></transition><transition><source ref="id10"/><target ref="id9"/><label kind="synchronisation" x="-1224" y="-440">gyro_test!</label></transition><transition><source ref="id19"/><target ref="id10"/><label kind="guard" x="-1264" y="-512">mode &gt; 0</label><label kind="synchronisation" x="-1288" y="-528">motor_stopped?</label></transition><transition><source ref="id12"/><target ref="id16"/><label kind="synchronisation" x="-1480" y="-120">button_startpause?</label><label kind="assignment" x="-1480" y="-104">machinePaused := 0</label><nail x="-1488" y="-96"/></transition><transition><source ref="id16"/><target ref="id16"/><label kind="guard" x="-1576" y="-312">machinePaused == 0</label><label kind="synchronisation" x="-1568" y="-328">button_startpause?</label><nail x="-1552" y="-288"/><nail x="-1472" y="-288"/></transition><transition><source ref="id14"/><target ref="id14"/><label kind="guard" x="-1160" y="232">machinePaused == 0</label><label kind="synchronisation" x="-1144" y="216">button_startpause?</label><nail x="-1128" y="216"/><nail x="-1048" y="216"/></transition><transition><source ref="id18"/><target ref="id18"/><label kind="guard" x="-1400" y="232">machinePaused == 0</label><label kind="synchronisation" x="-1384" y="216">button_startpause?</label><nail x="-1288" y="216"/><nail x="-1368" y="216"/></transition><transition><source ref="id15"/><target ref="id15"/><label kind="guard" x="-1152" y="-656">machinePaused == 0</label><label kind="synchronisation" x="-1144" y="-640">button_startpause?</label><nail x="-1136" y="-616"/><nail x="-1040" y="-616"/></transition><transition><source ref="id13"/><target ref="id17"/><label kind="synchronisation" x="-792" y="24">button_reset?</label><nail x="-1816" y="48"/><nail x="-1816" y="-192"/></transition><transition><source ref="id19"/><target ref="id19"/><label kind="guard" x="-1400" y="-664">machinePaused == 0</label><label kind="synchronisation" x="-1384" y="-648">button_startpause?</label><nail x="-1368" y="-624"/><nail x="-1288" y="-624"/></transition><transition><source ref="id16"/><target ref="id12"/><label kind="guard" x="-1664" y="-104">machinePaused == 1</label><nail x="-1528" y="-96"/></transition><transition><source ref="id20"/><target ref="id13"/><label kind="synchronisation" x="-480" y="-152">color_nothing?</label><nail x="-440" y="-112"/><nail x="-440" y="-72"/></transition><transition><source ref="id18"/><target ref="id16"/><label kind="guard" x="-1424" y="-152">mode == 0</label><label kind="synchronisation" x="-1448" y="-176">motor_stopped?</label><nail x="-1328" y="-176"/><nail x="-1488" y="-176"/></transition><transition><source ref="id19"/><target ref="id16"/><label kind="guard" x="-1432" y="-240">mode == 0</label><label kind="synchronisation" x="-1448" y="-256">motor_stopped?</label><nail x="-1328" y="-208"/><nail x="-1480" y="-208"/></transition><transition><source ref="id16"/><target ref="id17"/><label kind="guard" x="-1680" y="-152">machinePaused == 0</label><label kind="synchronisation" x="-1656" y="-168">button_reset?</label><nail x="-1616" y="-168"/></transition><transition><source ref="id14"/><target ref="id18"/><label kind="synchronisation" x="-1248" y="168">motor_right!</label></transition><transition><source ref="id15"/><target ref="id19"/><label kind="synchronisation" x="-1240" y="-584">motor_left!</label></transition><transition><source ref="id20"/><target ref="id14"/><label kind="synchronisation" x="-1080" y="-144">color_white?</label></transition><transition><source ref="id20"/><target ref="id15"/><label kind="synchronisation" x="-1080" y="-256">color_black?</label><nail x="-1088" y="-264"/></transition><transition><source ref="id16"/><target ref="id20"/><label kind="synchronisation" x="-1328" y="-216">color_test!</label></transition><transition><source ref="id17"/><target ref="id16"/><label kind="synchronisation" x="-1672" y="-256">button_startpause?</label><label kind="assignment" x="-1688" y="-216">machinePaused := 0</label><nail x="-1616" y="-216"/></transition></template><template><name>Motor</name><location id="id21" x="120" y="-48"></location><location id="id22" x="-176" y="-48"></location><location id="id23" x="-40" y="-48"></location><init ref="id23"/><transition><source ref="id22"/><target ref="id23"/><label kind="synchronisation" x="-184" y="-304">reset_per?</label><nail x="-128" y="-280"/></transition><transition><source ref="id21"/><target ref="id23"/><label kind="synchronisation" x="-56" y="-304">reset_per?</label><nail x="-24" y="-288"/></transition><transition><source ref="id21"/><target ref="id23"/><label kind="synchronisation" x="8" y="136">motor_jammed!</label><nail x="56" y="136"/></transition><transition><source ref="id22"/><target ref="id23"/><label kind="synchronisation" x="-160" y="136">motor_jammed!</label><nail x="-112" y="136"/></transition><transition><source ref="id21"/><target ref="id23"/><label kind="synchronisation" x="0" y="32">motor_stopped!</label><nail x="40" y="16"/></transition><transition><source ref="id22"/><target ref="id23"/><label kind="synchronisation" x="-160" y="32">motor_stopped!</label><nail x="-112" y="16"/></transition><transition><source ref="id23"/><target ref="id22"/><label kind="synchronisation" x="-136" y="-80">motor_left?</label><nail x="-104" y="-112"/></transition><transition><source ref="id23"/><target ref="id21"/><label kind="synchronisation" x="0" y="-80">motor_right?</label><nail x="40" y="-112"/></transition></template><template><name>ColorSensor</name><declaration>clock t;</declaration><location id="id24" x="24" y="-40"></location><location id="id25" x="-128" y="-40"></location><init ref="id25"/><transition><source ref="id24"/><target ref="id25"/><label kind="synchronisation" x="-88" y="88">color_nothing!</label><nail x="24" y="88"/><nail x="-128" y="88"/></transition><transition><source ref="id24"/><target ref="id25"/><label kind="synchronisation" x="-96" y="-208">color_unknown!</label><nail x="24" y="-184"/><nail x="-128" y="-184"/></transition><transition><source ref="id24"/><target ref="id25"/><label kind="synchronisation" x="-80" y="40">color_white!</label><nail x="-8" y="40"/><nail x="-88" y="40"/></transition><transition><source ref="id24"/><target ref="id25"/><label kind="synchronisation" x="-72" y="-128">color_black!</label><nail x="-24" y="-104"/><nail x="-88" y="-104"/></transition><transition><source ref="id25"/><target ref="id24"/><label kind="synchronisation" x="-88" y="-64">color_test?</label></transition></template><template><name>Buttons</name><location id="id26" x="0" y="0"></location><init ref="id26"/><transition><source ref="id26"/><target ref="id26"/><label kind="synchronisation" x="-40" y="-96">button_abort!</label><nail x="32" y="-64"/><nail x="-24" y="-64"/></transition><transition><source ref="id26"/><target ref="id26"/><label kind="synchronisation" x="-192" y="-24">button_startpause!</label><label kind="assignment" x="-208" y="0">machinePaused := 1</label><nail x="-72" y="-32"/><nail x="-72" y="24"/></transition><transition><source ref="id26"/><target ref="id26"/><label kind="synchronisation" x="72" y="-16">button_reset!</label><nail x="64" y="-32"/><nail x="64" y="24"/></transition></template><template><name>Timer</name><location id="id27" x="-16" y="-16"></location><init ref="id27"/><transition><source ref="id27"/><target ref="id27"/><label kind="synchronisation" x="-160" y="-24">timer_dfa!</label><nail x="-88" y="32"/><nail x="-88" y="-64"/></transition><transition><source ref="id27"/><target ref="id27"/><label kind="synchronisation" x="64" y="-32">timer_toolate!</label><nail x="56" y="32"/><nail x="56" y="-64"/></transition></template><system>// Processes
ProcessReinhardHeinrichBertramVinzenzFreiherrvonPeldengenanntCloudtzuLauersfortundImpel = ReinhardHeinrichBertramVinzenzFreiherrvonPeldengenanntCloudtzuLauersfortundImpel();
ProcessGyroSensor = GyroSensor();
ProcessMotor = Motor();
ProcessColorSensor = ColorSensor();
ProcessButtons = Buttons();
ProcessTimer = Timer();

// System
system ProcessReinhardHeinrichBertramVinzenzFreiherrvonPeldengenanntCloudtzuLauersfortundImpel, ProcessGyroSensor, ProcessMotor, ProcessColorSensor, ProcessButtons, ProcessTimer;</system></nta>